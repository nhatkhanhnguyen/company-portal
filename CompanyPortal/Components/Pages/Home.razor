@using MediatR
@using CompanyPortal.CQRS.Products.Queries
@using CompanyPortal.CQRS.Settings.Queries

@page "/"

@inject IMediator Mediator

<HomepageCarousel Images="_settings.CarouselImages" />
<AboutSection />
<StarredProductsSection Products="_starredProducts" />
<WhyUsSection />


@code {
    private List<ProductCardViewModel> _starredProducts = [];
    private List<SettingViewModel> _settings = [];

    protected override async Task OnInitializedAsync()
    {
        await GetSiteSettings();
        await GetStarredProducts();
    }

    private async Task GetSiteSettings()
    {
        var result = await Mediator.Send(new GetHomepageSettingsQuery());
        _settings = result.Data;
    }

    private async Task GetStarredProducts()
    {
        var result = await Mediator.Send(new GetStarredProductsQuery());
        _starredProducts = result.Data;
    }
}
